## ☀️ PCB (Process Control Block)

> 운영체제가 특정 프로세스에 대한 정보를 저장하는 데 사용하는 데이터 구조
> 
- 이 구조체는 프로세스의 상태, 프로그램 카운터, CPU 레지스터, CPU 스케줄링 정보, 메모리 관리 정보, 입출력 상태 정보 등을 포함한다.
- 프로세스 관리 및 스케줄링에 필수적인 정보를 유지하는 데 사용된다.
- PCB는 프로세스가 중단되었을 때 그 상태를 저장하는 데 사용되며, 나중에 프로세스를 재개할 때 이 정보를 사용하여 원래 상태로 복구한다.

### 1. **프로세스 식별자 (Process Identifier, PID)**

- 각 PCB는 고유한 프로세스 식별자(PID)를 가진다.
- 이 식별자는 프로세스를 구별하고, 시스템 내에서 프로세스를 추적하는 데 사용된다.

### **2. 프로세스 상태**

- 프로세스의 현재 상태
- 새로 생성됨 `New`, 실행 중 `Running`, 대기 중 `Waiting`, 준비 완료 `Ready`, 종료됨 `Terminated` 등

### **3. 프로그램 카운터**

- 프로세스가 다음에 실행할 명령어의 주소를 저장한다.
- CPU가 프로세스를 다시 시작할 때, 어디서부터 실행을 재개해야 하는지를 가리킨다.

### **4. CPU 레지스터**

- 프로세스의 실행 중에 사용되는 모든 레지스터 집합의 복사본을 포함한다.
- 프로세스가 중지되었을 때의 정확한 상태를 저장하는 데 중요하다.

### **5. CPU 스케줄링 정보**

- 프로세스의 우선 순위, 스케줄링 큐에 대한 포인터, 다른 스케줄링 매개변수 등을 포함한다.

### **6. 메모리 관리 정보**

- 프로세스의 메모리 할당에 대한 정보를 포함한다.
- 프로세스의 베이스 레지스터, 한계 레지스터, 페이지 테이블 또는 세그먼트 테이블과 같은 메모리 관리 시스템에 필요한 정보를 포함할 수 있다.

### **7. 계정 정보**

- 프로세스에 할당된 CPU 사용 시간, 제한 시간, 프로세스 ID, 부모 프로세스 ID 등의 정보를 포함한다.

### **8. 입출력 상태 정보**

- 프로세스에 의해 사용되는 모든 입출력 장치와 파일, 열린 파일 목록, 할당된 리소스 등에 대한 정보를 포함한다.

### **PCB의 중요성**

- **프로세스 관리**
    
    PCB는 프로세스 관리의 핵심이다. 운영 체제는 PCB를 사용하여 프로세스의 생성, 실행, 중지 및 종료를 관리한다.
    
- **컨텍스트 스위칭**
    
    프로세스 간의 컨텍스트 스위칭 시, 운영 체제는 현재 실행 중인 프로세스의 상태를 해당 PCB에 저장하고, 다음 실행할 프로세스의 PCB에서 상태를 복원한다.
    
- **멀티태스킹**
    
    멀티태스킹 환경에서 PCB는 여러 프로세스가 시스템 자원을 공유하며 효율적으로 실행될 수 있도록 한다.
    
- **보안 및 격리**
    
    PCB는 프로세스 간 격리를 제공하여 하나의 프로세스가 다른 프로세스의 작업에 부정적인 영향을 미치지 않도록 한다.
    
- **자원 추적 및 관리**
    
    시스템의 자원 사용을 추적하고 관리하는 데 필수적이다. 파일 핸들, 메모리 할당 등의 정보가 포함된다.

<br>

## ☀️ 컨텍스트 스위칭 (Context Switching)

> CPU가 한 프로세스에서 다른 프로세스로 전환할 때 발생하는 과정
> 
- 이 과정에서 현재 실행 중인 프로세스의 상태는 그 프로세스의 PCB에 저장되고, CPU는 다음 실행할 프로세스의 PCB에 저장된 상태를 로드한다.
- 멀티태스킹과 프로세스 스케줄링을 가능하게 하는 중요한 메커니즘
- 이를 통해 여러 프로세스가 동시에 실행되는 것처럼 보이며, 시스템의 자원을 효율적으로 사용할 수 있다.

### **컨텍스트 스위칭의 과정**

1. **인터럽트 또는 시스템 콜 발생**
    - 인터럽트나 시스템 콜에 의해 시작된다.
        - 인터럽트 예시) I/O 요청, 타이머 인터럽트
        - 시스템 콜 예시) 프로세스가 자원을 요청할 때
2. **현재 프로세스 상태의 저장**
    - CPU가 현재 실행 중인 프로세스의 상태를 `Process Control Block`(PCB)에 저장
    - 이 상태에는 프로그램 카운터, 레지스터 값, 메모리 할당 등이 포함된다.
3. **프로세스 상태의 변경**
    - 현재 프로세스의 상태는 `대기 중` 또는 `준비 완료`로 변경된다. 이는 PCB에 반영
4. **스케줄러 활성화**
    - 운영 체제의 스케줄러가 활성화되어, 다음에 실행할 프로세스를 결정
    - 우선 순위, 라운드-로빈(Round-Robin), 최단 작업 우선(Shortest Job First) 등의 알고리즘
5. **다음 프로세스의 상태 로드**
    - 스케줄러에 의해 선택된 다음 프로세스의 상태가 해당 프로세스의 PCB에서 CPU에 로드
6. **새 프로세스의 실행**
    - 새로운 프로세스가 CPU에서 실행을 시작
    - 이 때, 프로그램 카운터와 레지스터 값은 PCB에서 로드된 값으로 설정된다.

### **효과**

1. **멀티태스킹**
    - 여러 프로세스가 동시에 실행되는 것처럼 보이게 하여, 시스템의 자원을 효율적으로 사용할 수 있게 한다.
2. **시스템 자원의 공유**
    - 다수의 사용자 또는 프로세스가 시스템 자원을 공유할 수 있다.
3. **시스템 응답성 향상**
    - 사용자 인터페이스, 네트워크 요청 등에 대한 응답 시간을 단축시킬 수 있다.
4. **프로세스 간 통신**
    - 프로세스 간에 데이터를 교환하고, 서로 협력하는 복잡한 작업을 수행할 수 있다.

### **단점**

1. **오버헤드**
    - 컨텍스트 스위칭은 시간과 시스템 자원을 소비
    - 너무 자주 발생하면 시스템의 성능에 부정적인 영향
2. **캐시 불일치**
    - 새 프로세스로 전환될 때 CPU 캐시에 있는 데이터가 이전 프로세스의 데이터와 불일치할 수 있어, 이로 인해 **캐시 미스가 발생**하고 **성능 저하**가 일어날 수 있다.
3. **최적화의 어려움**
    - 다양한 프로세스가 동시에 실행될 때, 각각에 적절한 자원을 할당하고 관리하는 것이 복잡해진다.
